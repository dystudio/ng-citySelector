!function(e){function t(e){var t={};if(e.map(function(e){var n=e.py[0].toLowerCase();t[n]?t[n].push(e):t[n]=[e]}),0!==Object.keys(t).length)var n=Object.keys(t).map(function(e){return t[e]}).sort(function(e,t){return e[0].py.charCodeAt(0)-t[0].py.charCodeAt(0)});return n}function n(e){if(!e)throw"ng-cs-data must is empty";if(null!==e&&"object"==typeof e)return e}function i(e){hs=r.getItem("__historySearch__")||null,hs?hs.indexOf(e)===-1&&localStorage.setItem("__historySearch__",e+","+hs):localStorage.setItem("__historySearch__",e)}function c(){if(r){hs=r.getItem("__historySearch__")||null;try{if(hs)return hs.split(",").slice(0,5)}catch(e){}}else;}var a=angular.module("ngCitySelector",["ngTouch"]);a.version="1.0.0";var r=window.localStorage;a.directive("ngCitySelector",[function(){return{restrict:"AE",replace:!0,scope:{ngCsModel:"=",ngCsData:"=",ngCsFn:"="},template:'<div class="container country country__show-recent cityselector">                                <div class="container-hd">                                        <!-- S 搜索 -->                                    <div class="country-search country-search__active">                                    <div class="country-search_txt">                                    <i class="icon-img icon-img-search02"></i>                                    <span class="txt">搜索</span>                                    </div>                                    <input class="country-search-ipt" type="text" ng-model="search" id="search">                                    </div>                                        <!-- E 搜索 -->                                        <!-- S 最近搜索 -->                                    <div class="country-recent">                                    <div class="country-recent-title">最近搜索</div>                                    <ul class="country-recent-list">                                    <li class="list-item" ng-repeat="h in hisSearch" ng-click="selectHis(h)">{{h}}</li>                            </ul>                            </div>                                <!-- E 最近搜索 -->                            </div>                            <div class="container-bd">                                    <!-- S 选择城市 -->                                <div class="cityselector">                                <div class="city-wrap">                                <p class="city-title" ng-repeat-start="i in csData | filter: search" ng-attr-id="{{\'group-\' + i[0][\'py\'][0]}}">{{i[0].py[0] | uppercase}}</p>                        <ul class="city-list" ng-repeat-end>                        <li class="city-list-item" ng-repeat="j in i | filter: search" ng-click="selectItem(j)">                            <span ng-bind="j.name"></span>                            </li>                            </ul>                            </div>                            <ul class="anchor-list">                            <li ng-repeat="h in csData" ng-touchmove="touchMoveFn($event)" ng-touchstart="touchStartFn($event)" ng-touchend="touchEndFn($event)">                            <a href="javascript:;">{{h[0].py[0] | uppercase}}</a>                        </li>                        </ul>                        </div>                            <!-- E 选择城市 -->                        </div>                        <div class="item-tip" ng-show="isShowTip">A</div>                     </div>',link:function(e,a,r){var s=e.ngCsData,l=n(s);e.hisSearch=c(),e.csData=t(l),e.search="";var o=document.querySelectorAll(".item-tip")[0];e.isShowTip=!1;var u=function(e){var t="group-"+e.toLowerCase(),n=document.getElementById(t);if(n){var i=n.getBoundingClientRect().top-97;window.scrollBy(0,i)}};e.selectHis=function(t){e.search=t;var n=l.filter(function(e){return e.name===t});n&&e.ngCsFn(n[0])},e.selectItem=function(t){var n=angular.element(document.getElementById("search")).val();!n||t.name.indexOf(n)===-1&&t.py.indexOf(n)===-1||i(t.name),e.ngCsFn(t)},e.touchStartFn=function(t){var n=t.target.innerHTML;angular.element(t.target).addClass("active"),o.innerHTML!==n&&(e.isShowTip=!0,o.innerHTML=n,u(n)),t.preventDefault()},e.touchMoveFn=function(e){var t=e.changedTouches[0],n=document.elementFromPoint(t.clientX,t.clientY),i=angular.element(n).parent().parent();if(i.hasClass("anchor-list")){var c=n.innerHTML;o.innerHTML!==c&&(o.innerHTML=c,u(c))}e.preventDefault()},e.touchEndFn=function(t){angular.element(t.target).removeClass("active"),e.isShowTip=!1,t.preventDefault()}}}}])}();